<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HealthHub - Medical Appointment System</title>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2980b9;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --success-color: #2ecc71;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        header {
            background-color: var(--primary-color);
            color: white;
            padding: 20px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 24px;
            font-weight: bold;
        }
        
        .nav-links {
            display: flex;
            list-style: none;
        }
        
        .nav-links li {
            margin-left: 20px;
        }
        
        .nav-links a {
            color: white;
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .nav-links a:hover {
            color: var(--light-color);
        }
        
        .btn {
            display: inline-block;
            background-color: var(--primary-color);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            transition: background-color 0.3s;
        }
        
        .btn:hover {
            background-color: var(--secondary-color);
        }
        
        .btn-danger {
            background-color: var(--danger-color);
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
        }
        
        .btn-success {
            background-color: var(--success-color);
        }
        
        .btn-success:hover {
            background-color: #27ae60;
        }
        
        .hero {
            background-color: var(--secondary-color);
            color: white;
            padding: 60px 0;
            text-align: center;
        }
        
        .hero h1 {
            font-size: 48px;
            margin-bottom: 20px;
        }
        
        .hero p {
            font-size: 20px;
            max-width: 800px;
            margin: 0 auto 30px;
        }
        
        .section {
            padding: 60px 0;
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 40px;
            font-size: 36px;
            color: var(--dark-color);
        }
        
        .card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .card-title {
            font-size: 20px;
            margin-bottom: 15px;
            color: var(--primary-color);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        
        .status-pending {
            color: var(--warning-color);
            font-weight: bold;
        }
        
        .status-confirmed {
            color: var(--success-color);
            font-weight: bold;
        }
        
        .status-canceled {
            color: var(--danger-color);
            font-weight: bold;
        }
        
        .status-completed {
            color: var(--primary-color);
            font-weight: bold;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background-color: var(--primary-color);
            color: white;
        }
        
        tr:hover {
            background-color: #f5f5f5;
        }
        
        footer {
            background-color: var(--dark-color);
            color: white;
            text-align: center;
            padding: 20px 0;
            margin-top: 40px;
        }
        
        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
        }
        
        .modal-content {
            background-color: white;
            margin: 10% auto;
            padding: 20px;
            border-radius: 8px;
            width: 80%;
            max-width: 600px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .close:hover {
            color: black;
        }
        
        /* Dashboard layout */
        .dashboard {
            display: grid;
            grid-template-columns: 250px 1fr;
            min-height: calc(100vh - 120px);
        }
        
        .sidebar {
            background-color: var(--dark-color);
            color: white;
            padding: 20px;
        }
        
        .sidebar-menu {
            list-style: none;
        }
        
        .sidebar-menu li {
            margin-bottom: 15px;
        }
        
        .sidebar-menu a {
            color: white;
            text-decoration: none;
            display: block;
            padding: 10px;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        
        .sidebar-menu a:hover, .sidebar-menu a.active {
            background-color: var(--primary-color);
        }
        
        .main-content {
            padding: 20px;
            background-color: white;
        }
        
        /* Responsive styles */
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                display: none;
            }
            
            .hero h1 {
                font-size: 36px;
            }
            
            .hero p {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <nav>
                <div class="logo">HealthHub</div>
                <ul class="nav-links">
                    <li><a href="#" onclick="showSection('home')">Home</a></li>
                    <li><a href="#" onclick="showSection('services')">Services</a></li>
                    <li><a href="#" onclick="showLoginModal()">Login</a></li>
                    <li><a href="#" onclick="showSignupModal()">Sign Up</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <section class="hero" id="home-section">
        <div class="container">
            <h1>Your Health, Our Priority</h1>
            <p>Book appointments with top healthcare professionals easily and conveniently from the comfort of your home.</p>
            <a href="#" class="btn" onclick="showSignupModal()">Get Started</a>
        </div>
    </section>

    <section class="section" id="services-section" style="display: none;">
        <div class="container">
            <h2 class="section-title">Our Services</h2>
            <div class="grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                <div class="card">
                    <h3 class="card-title">Doctor Appointments</h3>
                    <p>Book consultations with specialists in various fields including cardiology, neurology, pediatrics, and more.</p>
                </div>
                <div class="card">
                    <h3 class="card-title">Health Checkups</h3>
                    <p>Schedule comprehensive health checkups and diagnostic tests at your convenience.</p>
                </div>
                <div class="card">
                    <h3 class="card-title">Online Consultations</h3>
                    <p>Connect with doctors through secure video calls for remote consultations.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('loginModal')">&times;</span>
            <h2>Login</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label for="loginEmail">Email</label>
                    <input type="email" id="loginEmail" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="loginRole">Role</label>
                    <select id="loginRole" class="form-control" required>
                        <option value="">Select Role</option>
                        <option value="patient">Patient</option>
                        <option value="practitioner">Practitioner</option>
                    </select>
                </div>
                <button type="submit" class="btn">Login</button>
                <p style="margin-top: 15px; text-align: center;">
                    <a href="#" onclick="showAdminLoginModal()" style="color: var(--primary-color);">Admin Login</a>
                </p>
            </form>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div id="adminLoginModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('adminLoginModal')">&times;</span>
            <h2>Admin Login</h2>
            <form id="adminLoginForm">
                <div class="form-group">
                    <label for="adminUsername">Username</label>
                    <input type="text" id="adminUsername" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="adminPassword">Password</label>
                    <input type="password" id="adminPassword" class="form-control" required>
                </div>
                <button type="submit" class="btn">Login</button>
            </form>
        </div>
    </div>

    <!-- Signup Modal -->
    <div id="signupModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('signupModal')">&times;</span>
            <h2>Sign Up</h2>
            <form id="signupForm">
                <div class="form-group">
                    <label for="signupName">Full Name</label>
                    <input type="text" id="signupName" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="signupEmail">Email</label>
                    <input type="email" id="signupEmail" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="signupPassword">Password</label>
                    <input type="password" id="signupPassword" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="signupPhone">Phone Number</label>
                    <input type="tel" id="signupPhone" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="signupRole">I am a</label>
                    <select id="signupRole" class="form-control" required onchange="toggleSpecializationField()">
                        <option value="">Select Role</option>
                        <option value="patient">Patient</option>
                        <option value="practitioner">Healthcare Practitioner</option>
                    </select>
                </div>
                <div class="form-group" id="specializationGroup" style="display: none;">
                    <label for="signupSpecialization">Specialization</label>
                    <input type="text" id="signupSpecialization" class="form-control">
                </div>
                <button type="submit" class="btn">Sign Up</button>
            </form>
        </div>
    </div>

    <!-- Dashboard (hidden by default) -->
    <div id="dashboard" style="display: none;">
        <div class="dashboard">
            <div class="sidebar">
                <ul class="sidebar-menu">
                    <li><a href="#" class="active" onclick="showDashboardSection('overview')">Overview</a></li>
                    <li><a href="#" onclick="showDashboardSection('appointments')">Appointments</a></li>
                    <li><a href="#" onclick="showDashboardSection('profile')">Profile</a></li>
                    <li id="adminMenu" style="display: none;"><a href="#" onclick="showDashboardSection('admin')">Admin Panel</a></li>
                    <li><a href="#" onclick="logout()">Logout</a></li>
                </ul>
            </div>
            <div class="main-content">
                <!-- Overview Section -->
                <div id="overview-section">
                    <h2>Dashboard Overview</h2>
                    <div class="card">
                        <h3 class="card-title">Welcome, <span id="userName"></span></h3>
                        <p id="userRoleInfo"></p>
                    </div>
                    
                    <div class="grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 20px;">
                        <div class="card">
                            <h3 class="card-title">Upcoming Appointments</h3>
                            <div id="upcomingAppointments">
                                <p>Loading...</p>
                            </div>
                        </div>
                        <div class="card">
                            <h3 class="card-title">Quick Actions</h3>
                            <div id="quickActions">
                                <!-- Dynamic quick actions based on role -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Appointments Section -->
                <div id="appointments-section" style="display: none;">
                    <h2>Appointments</h2>
                    <div class="card">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h3 class="card-title" id="appointmentsTitle">Your Appointments</h3>
                            <button class="btn" id="bookAppointmentBtn" style="display: none;" onclick="showBookAppointmentModal()">Book New Appointment</button>
                        </div>
                        
                        <table>
                            <thead>
                                <tr>
                                    <th>Date & Time</th>
                                    <th id="appointmentWithHeader">With</th>
                                    <th>Specialization</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="appointmentsTable">
                                <!-- Appointments will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Profile Section -->
                <div id="profile-section" style="display: none;">
                    <h2>Profile</h2>
                    <div class="card">
                        <h3 class="card-title">Personal Information</h3>
                        <form id="profileForm">
                            <div class="form-group">
                                <label for="profileName">Full Name</label>
                                <input type="text" id="profileName" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="profileEmail">Email</label>
                                <input type="email" id="profileEmail" class="form-control" required readonly>
                            </div>
                            <div class="form-group">
                                <label for="profilePhone">Phone Number</label>
                                <input type="tel" id="profilePhone" class="form-control" required>
                            </div>
                            <div id="profileSpecializationGroup" class="form-group" style="display: none;">
                                <label for="profileSpecialization">Specialization</label>
                                <input type="text" id="profileSpecialization" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="profilePassword">New Password (leave blank to keep current)</label>
                                <input type="password" id="profilePassword" class="form-control">
                            </div>
                            <button type="submit" class="btn">Update Profile</button>
                        </form>
                    </div>
                </div>
                
                <!-- Admin Section -->
                <div id="admin-section" style="display: none;">
                    <h2>Admin Panel</h2>
                    
                    <div class="card">
                        <h3 class="card-title">Pending Approvals</h3>
                        
                        <h4>Patients</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Phone</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="pendingPatientsTable">
                                <!-- Pending patients will be populated here -->
                            </tbody>
                        </table>
                        
                        <h4 style="margin-top: 20px;">Practitioners</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Phone</th>
                                    <th>Specialization</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="pendingPractitionersTable">
                                <!-- Pending practitioners will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Book Appointment Modal -->
    <div id="bookAppointmentModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('bookAppointmentModal')">&times;</span>
            <h2>Book New Appointment</h2>
            <form id="appointmentForm">
                <div class="form-group">
                    <label for="appointmentPractitioner">Practitioner</label>
                    <select id="appointmentPractitioner" class="form-control" required>
                        <option value="">Select Practitioner</option>
                        <!-- Practitioners will be populated here -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="appointmentDate">Date</label>
                    <input type="date" id="appointmentDate" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="appointmentTime">Time</label>
                    <input type="time" id="appointmentTime" class="form-control" required>
                </div>
                <button type="submit" class="btn">Book Appointment</button>
            </form>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>&copy; 2023 HealthHub. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // Current user data
        let currentUser = null;
        let currentRole = null;
        
        // Mock data for demonstration
        const practitioners = [
            { id: 1, name: "Dr. Smith", specialization: "Cardiology", email: "dr.smith@example.com" },
            { id: 2, name: "Dr. Johnson", specialization: "Neurology", email: "dr.johnson@example.com" }
        ];
        
        const pendingPatients = [
            { id: 2, name: "Jane Smith", email: "jane@example.com", phone: "0987654321" }
        ];
        
        const pendingPractitioners = [
            { id: 2, name: "Dr. Johnson", email: "dr.johnson@example.com", phone: "4445556666", specialization: "Neurology" }
        ];
        
        // Sample appointments data
        let appointments = [
            { 
                id: 1, 
                patientId: 1, 
                patientName: "John Doe",
                patientEmail: "john@example.com",
                practitionerId: 1, 
                practitionerName: "Dr. Smith", 
                practitionerEmail: "dr.smith@example.com",
                specialization: "Cardiology",
                date: "2023-12-15T10:00:00", 
                status: "CONFIRMED" 
            },
            { 
                id: 2, 
                patientId: 1, 
                patientName: "John Doe",
                patientEmail: "john@example.com",
                practitionerId: 1, 
                practitionerName: "Dr. Smith", 
                practitionerEmail: "dr.smith@example.com",
                specialization: "Cardiology",
                date: "2023-12-20T14:30:00", 
                status: "PENDING" 
            },
            { 
                id: 3, 
                patientId: 2, 
                patientName: "Jane Smith",
                patientEmail: "jane@example.com",
                practitionerId: 2, 
                practitionerName: "Dr. Johnson", 
                practitionerEmail: "dr.johnson@example.com",
                specialization: "Neurology",
                date: "2023-12-18T11:00:00", 
                status: "CANCELED" 
            }
        ];
        
        // DOM ready
        document.addEventListener('DOMContentLoaded', function() {
            // Form submissions
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            document.getElementById('adminLoginForm').addEventListener('submit', handleAdminLogin);
            document.getElementById('signupForm').addEventListener('submit', handleSignup);
            document.getElementById('profileForm').addEventListener('submit', handleProfileUpdate);
            document.getElementById('appointmentForm').addEventListener('submit', handleBookAppointment);
        });
        
        // Show section
        function showSection(sectionId) {
            document.getElementById('home-section').style.display = 'none';
            document.getElementById('services-section').style.display = 'none';
            
            if (sectionId === 'home') {
                document.getElementById('home-section').style.display = 'block';
            } else if (sectionId === 'services') {
                document.getElementById('services-section').style.display = 'block';
            }
        }
        
        // Show modal
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }
        
        // Close modal
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        // Show login modal
        function showLoginModal() {
            showModal('loginModal');
        }
        
        // Show admin login modal
        function showAdminLoginModal() {
            closeModal('loginModal');
            showModal('adminLoginModal');
        }
        
        // Show signup modal
        function showSignupModal() {
            showModal('signupModal');
        }
        
        // Show book appointment modal
        function showBookAppointmentModal() {
            // Populate practitioners dropdown
            const select = document.getElementById('appointmentPractitioner');
            select.innerHTML = '<option value="">Select Practitioner</option>';
            
            practitioners.forEach(practitioner => {
                if (practitioner.approved) {
                    const option = document.createElement('option');
                    option.value = practitioner.id;
                    option.textContent = `${practitioner.name} (${practitioner.specialization})`;
                    select.appendChild(option);
                }
            });
            
            // Set minimum date to today
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('appointmentDate').min = today;
            
            showModal('bookAppointmentModal');
        }
        
        // Toggle specialization field in signup form
        function toggleSpecializationField() {
            const role = document.getElementById('signupRole').value;
            const specializationGroup = document.getElementById('specializationGroup');
            
            if (role === 'practitioner') {
                specializationGroup.style.display = 'block';
                document.getElementById('signupSpecialization').required = true;
            } else {
                specializationGroup.style.display = 'none';
                document.getElementById('signupSpecialization').required = false;
            }
        }
        
        // Show dashboard section
        function showDashboardSection(sectionId) {
            document.getElementById('overview-section').style.display = 'none';
            document.getElementById('appointments-section').style.display = 'none';
            document.getElementById('profile-section').style.display = 'none';
            document.getElementById('admin-section').style.display = 'none';
            
            // Update active menu item
            const menuItems = document.querySelectorAll('.sidebar-menu a');
            menuItems.forEach(item => item.classList.remove('active'));
            
            event.target.classList.add('active');
            
            // Show the selected section
            document.getElementById(`${sectionId}-section`).style.display = 'block';
            
            // Load data if needed
            if (sectionId === 'appointments') {
                loadAppointments();
            } else if (sectionId === 'admin') {
                loadAdminData();
            } else if (sectionId === 'overview') {
                loadUpcomingAppointments();
            }
        }
        
        // Handle login
        function handleLogin(event) {
            event.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const role = document.getElementById('loginRole').value;
            
            // In a real app, this would be an API call
            console.log(`Login attempt: ${email}, role: ${role}`);
            
            // Mock authentication
            if (password === 'password123') {
                if (role === 'patient') {
                    // Find patient
                    const patient = pendingPatients.find(p => p.email === email) || 
                                  { id: 1, name: 'John Doe', email: 'john@example.com', phone: '1234567890' };
                    
                    if (patient) {
                        currentUser = patient;
                        currentRole = 'patient';
                    }
                } else if (role === 'practitioner') {
                    // Find practitioner
                    const practitioner = pendingPractitioners.find(p => p.email === email) || 
                                       practitioners.find(p => p.email === email);
                    
                    if (practitioner) {
                        currentUser = practitioner;
                        currentRole = 'practitioner';
                    }
                }
                
                if (currentUser) {
                    // Hide login modal and show dashboard
                    closeModal('loginModal');
                    showDashboard();
                    
                    // Hide admin menu if not admin
                    document.getElementById('adminMenu').style.display = 'none';
                    
                    // Update UI
                    updateUIAfterLogin();
                } else {
                    alert('User not found. Please check your credentials or sign up.');
                }
            } else {
                alert('Invalid credentials. Please try again.');
            }
        }
        
        // Handle admin login
        function handleAdminLogin(event) {
            event.preventDefault();
            
            const username = document.getElementById('adminUsername').value;
            const password = document.getElementById('adminPassword').value;
            
            // Mock admin authentication
            if (username === 'admin' && password === 'admin123') {
                currentUser = { 
                    id: 1,
                    name: 'Admin',
                    email: 'admin@healthhub.com'
                };
                currentRole = 'admin';
                
                // Hide login modal and show dashboard
                closeModal('adminLoginModal');
                showDashboard();
                
                // Show admin menu
                document.getElementById('adminMenu').style.display = 'block';
                
                // Update UI
                updateUIAfterLogin();
            } else {
                alert('Invalid admin credentials. Please try again.');
            }
        }
        
        // Handle signup
        function handleSignup(event) {
            event.preventDefault();
            
            const name = document.getElementById('signupName').value;
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;
            const phone = document.getElementById('signupPhone').value;
            const role = document.getElementById('signupRole').value;
            const specialization = document.getElementById('signupSpecialization').value;
            
            // In a real app, this would be an API call
            console.log(`Signup: ${name}, ${email}, role: ${role}`);
            
            // Mock user creation
            const newId = Math.max(...pendingPatients.map(p => p.id), ...pendingPractitioners.map(p => p.id)) + 1;
            
            if (role === 'patient') {
                currentUser = { 
                    id: newId,
                    name: name,
                    email: email,
                    phone: phone
                };
                currentRole = 'patient';
                
                pendingPatients.push({
                    id: newId,
                    name: name,
                    email: email,
                    phone: phone
                });
            } else if (role === 'practitioner') {
                currentUser = { 
                    id: newId,
                    name: name,
                    email: email,
                    phone: phone,
                    specialization: specialization
                };
                currentRole = 'practitioner';
                
                pendingPractitioners.push({
                    id: newId,
                    name: name,
                    email: email,
                    phone: phone,
                    specialization: specialization
                });
            }
            
            if (currentUser) {
                // Hide signup modal and show dashboard
                closeModal('signupModal');
                showDashboard();
                
                // Update UI
                updateUIAfterLogin();
                
                alert(`Account created successfully! ${role === 'practitioner' ? 'Your account is pending admin approval.' : ''}`);
            }
        }
        
        // Handle profile update
        function handleProfileUpdate(event) {
            event.preventDefault();
            
            const name = document.getElementById('profileName').value;
            const phone = document.getElementById('profilePhone').value;
            const password = document.getElementById('profilePassword').value;
            const specialization = document.getElementById('profileSpecialization').value;
            
            // Update user data
            currentUser.name = name;
            currentUser.phone = phone;
            if (password) {
                console.log('Password updated');
            }
            if (specialization) {
                currentUser.specialization = specialization;
            }
            
            // Update mock data
            if (currentRole === 'patient') {
                const patient = pendingPatients.find(p => p.id === currentUser.id) || 
                              { id: currentUser.id, name: name, email: currentUser.email, phone: phone };
                patient.name = name;
                patient.phone = phone;
            } else if (currentRole === 'practitioner') {
                const practitioner = pendingPractitioners.find(p => p.id === currentUser.id) || 
                                   practitioners.find(p => p.id === currentUser.id);
                if (practitioner) {
                    practitioner.name = name;
                    practitioner.phone = phone;
                    practitioner.specialization = specialization;
                }
            }
            
            alert('Profile updated successfully!');
        }
        
        // Handle book appointment
        function handleBookAppointment(event) {
            event.preventDefault();
            
            const practitionerId = parseInt(document.getElementById('appointmentPractitioner').value);
            const date = document.getElementById('appointmentDate').value;
            const time = document.getElementById('appointmentTime').value;
            
            // Combine date and time
            const dateTime = `${date}T${time}:00`;
            
            // Find practitioner
            const practitioner = practitioners.find(p => p.id === practitionerId);
            
            // Create new appointment
            const newAppointment = {
                id: appointments.length + 1,
                patientId: currentUser.id,
                patientName: currentUser.name,
                patientEmail: currentUser.email,
                practitionerId: practitionerId,
                practitionerName: practitioner.name,
                practitionerEmail: practitioner.email,
                specialization: practitioner.specialization,
                date: dateTime,
                status: 'PENDING'
            };
            
            appointments.push(newAppointment);
            
            // Close modal and refresh appointments
            closeModal('bookAppointmentModal');
            loadAppointments();
            loadUpcomingAppointments();
            
            alert('Appointment booked successfully!');
        }
        
        // Show dashboard
        function showDashboard() {
            document.getElementById('home-section').style.display = 'none';
            document.getElementById('services-section').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
        }
        
        // Update UI after login
        function updateUIAfterLogin() {
            // Set user name
            document.getElementById('userName').textContent = currentUser.name;
            
            // Set role-specific information
            const roleInfo = document.getElementById('userRoleInfo');
            const quickActions = document.getElementById('quickActions');
            
            if (currentRole === 'admin') {
                roleInfo.textContent = 'Administrator Dashboard';
                quickActions.innerHTML = `
                    <ul>
                        <li><a href="#" onclick="showDashboardSection('admin')">Review Pending Approvals</a></li>
                        <li><a href="#" onclick="showDashboardSection('appointments')">View All Appointments</a></li>
                    </ul>
                `;
            } else if (currentRole === 'practitioner') {
                roleInfo.textContent = 'Practitioner Dashboard';
                quickActions.innerHTML = `
                    <ul>
                        <li><a href="#" onclick="showDashboardSection('appointments')">View Your Appointments</a></li>
                        <li><a href="#" onclick="showDashboardSection('profile')">Update Your Profile</a></li>
                    </ul>
                `;
            } else if (currentRole === 'patient') {
                roleInfo.textContent = 'Patient Dashboard';
                quickActions.innerHTML = `
                    <ul>
                        <li><a href="#" onclick="showBookAppointmentModal()">Book New Appointment</a></li>
                        <li><a href="#" onclick="showDashboardSection('appointments')">View Your Appointments</a></li>
                    </ul>
                `;
            }
            
            // Update profile form
            document.getElementById('profileName').value = currentUser.name;
            document.getElementById('profileEmail').value = currentUser.email || '';
            document.getElementById('profilePhone').value = currentUser.phone || '';
            
            // Show/hide specialization field based on role
            const specializationGroup = document.getElementById('profileSpecializationGroup');
            if (currentRole === 'practitioner') {
                specializationGroup.style.display = 'block';
                document.getElementById('profileSpecialization').value = currentUser.specialization || '';
            } else {
                specializationGroup.style.display = 'none';
            }
            
            // Show/hide book appointment button based on role
            document.getElementById('bookAppointmentBtn').style.display = 
                currentRole === 'patient' ? 'block' : 'none';
            
            // Update appointments title based on role
            document.getElementById('appointmentsTitle').textContent = 
                currentRole === 'admin' ? 'All Appointments' : 'Your Appointments';
            
            // Update "With" column header based on role
            document.getElementById('appointmentWithHeader').textContent = 
                currentRole === 'patient' ? 'Practitioner' : 
                currentRole === 'practitioner' ? 'Patient' : 'Details';
            
            // Load initial data
            loadUpcomingAppointments();
        }
        
        // Load upcoming appointments for overview
        function loadUpcomingAppointments() {
            const container = document.getElementById('upcomingAppointments');
            
            // Filter upcoming appointments (next 7 days)
            const now = new Date();
            const nextWeek = new Date(now.getTime() + 7 * 24 * 60 * 60 * 1000);
            
            let userAppointments = [];
            if (currentRole === 'patient') {
                userAppointments = appointments.filter(a => a.patientId === currentUser.id);
            } else if (currentRole === 'practitioner') {
                userAppointments = appointments.filter(a => a.practitionerId === currentUser.id);
            } else if (currentRole === 'admin') {
                userAppointments = [...appointments];
            }
            
            const upcoming = userAppointments.filter(a => {
                const apptDate = new Date(a.date);
                return apptDate > now && apptDate < nextWeek && a.status !== 'CANCELED';
            });
            
            if (upcoming.length === 0) {
                container.innerHTML = '<p>No upcoming appointments in the next 7 days</p>';
                return;
            }
            
            let html = '<ul style="list-style: none;">';
            upcoming.forEach(appt => {
                const date = new Date(appt.date);
                const dateStr = date.toLocaleDateString();
                const timeStr = date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                
                html += `
                    <li style="padding: 10px 0; border-bottom: 1px solid #eee;">
                        <strong>${dateStr} at ${timeStr}</strong><br>
                        ${currentRole === 'patient' ? `With ${appt.practitionerName}` : 
                         currentRole === 'practitioner' ? `Patient: ${appt.patientName}` :
                         `Patient: ${appt.patientName}<br>Practitioner: ${appt.practitionerName}`}<br>
                        Status: <span class="status-${appt.status.toLowerCase()}">${appt.status}</span>
                    </li>
                `;
            });
            html += '</ul>';
            
            container.innerHTML = html;
        }
        
        // Load all appointments with role-specific columns and actions
        function loadAppointments() {
            const tableBody = document.getElementById('appointmentsTable');
            tableBody.innerHTML = '';
            
            let userAppointments = [];
            if (currentRole === 'patient') {
                userAppointments = appointments.filter(a => a.patientId === currentUser.id);
            } else if (currentRole === 'practitioner') {
                userAppointments = appointments.filter(a => a.practitionerId === currentUser.id);
            } else if (currentRole === 'admin') {
                userAppointments = [...appointments];
            }
            
            if (userAppointments.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="5" style="text-align: center;">No appointments found</td></tr>';
                return;
            }
            
            // Sort by date (newest first)
            userAppointments.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            userAppointments.forEach(appt => {
                const date = new Date(appt.date);
                const dateStr = date.toLocaleDateString();
                const timeStr = date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                
                const row = document.createElement('tr');
                
                // Common columns
                let rowContent = `
                    <td>${dateStr} at ${timeStr}</td>
                    <td>${getAppointmentWithColumn(appt)}</td>
                    <td>${appt.specialization}</td>
                    <td><span class="status-${appt.status.toLowerCase()}">${appt.status}</span></td>
                    <td>${getActionButtons(appt)}</td>
                `;
                
                row.innerHTML = rowContent;
                tableBody.appendChild(row);
            });
        }
        
        // Get the "With" column content based on role
        function getAppointmentWithColumn(appt) {
            if (currentRole === 'admin') {
                return `Patient: ${appt.patientName}<br>Practitioner: ${appt.practitionerName}`;
            } else if (currentRole === 'patient') {
                return appt.practitionerName;
            } else { // practitioner
                return appt.patientName;
            }
        }
        
        // Get action buttons based on role and appointment status
        function getActionButtons(appt) {
            let buttons = '';
            
            if (currentRole === 'admin') {
                if (appt.status === 'PENDING') {
                    buttons = `
                        <button class="btn btn-success" onclick="updateAppointmentStatus(${appt.id}, 'CONFIRMED')">Confirm</button>
                        <button class="btn btn-danger" onclick="updateAppointmentStatus(${appt.id}, 'CANCELED')">Cancel</button>
                    `;
                } else if (appt.status === 'CONFIRMED') {
                    buttons = `
                        <button class="btn" onclick="updateAppointmentStatus(${appt.id}, 'COMPLETED')">Mark Complete</button>
                    `;
                }
            } 
            else if (currentRole === 'practitioner') {
                if (appt.status === 'PENDING') {
                    buttons = `
                        <button class="btn btn-success" onclick="updateAppointmentStatus(${appt.id}, 'CONFIRMED')">Confirm</button>
                        <button class="btn btn-danger" onclick="updateAppointmentStatus(${appt.id}, 'CANCELED')">Reject</button>
                    `;
                } else if (appt.status === 'CONFIRMED') {
                    buttons = `
                        <button class="btn" onclick="updateAppointmentStatus(${appt.id}, 'COMPLETED')">Mark Complete</button>
                        <button class="btn btn-danger" onclick="updateAppointmentStatus(${appt.id}, 'CANCELED')">Cancel</button>
                    `;
                }
            }
            else if (currentRole === 'patient') {
                if (appt.status === 'PENDING' || appt.status === 'CONFIRMED') {
                    buttons = `
                        <button class="btn btn-danger" onclick="cancelAppointment(${appt.id})">Cancel</button>
                    `;
                }
            }
            
            return buttons;
        }
        
        // Load admin data
        function loadAdminData() {
            // Pending patients
            const patientsTable = document.getElementById('pendingPatientsTable');
            patientsTable.innerHTML = '';
            
            if (pendingPatients.length === 0) {
                patientsTable.innerHTML = '<tr><td colspan="4" style="text-align: center;">No pending patients</td></tr>';
            } else {
                pendingPatients.forEach(patient => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${patient.name}</td>
                        <td>${patient.email}</td>
                        <td>${patient.phone}</td>
                        <td>
                            <button class="btn btn-success" onclick="approveUser('patient', ${patient.id})">Approve</button>
                            <button class="btn btn-danger" onclick="rejectUser('patient', ${patient.id})">Reject</button>
                        </td>
                    `;
                    patientsTable.appendChild(row);
                });
            }
            
            // Pending practitioners
            const practitionersTable = document.getElementById('pendingPractitionersTable');
            practitionersTable.innerHTML = '';
            
            if (pendingPractitioners.length === 0) {
                practitionersTable.innerHTML = '<tr><td colspan="5" style="text-align: center;">No pending practitioners</td></tr>';
            } else {
                pendingPractitioners.forEach(practitioner => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${practitioner.name}</td>
                        <td>${practitioner.email}</td>
                        <td>${practitioner.phone}</td>
                        <td>${practitioner.specialization}</td>
                        <td>
                            <button class="btn btn-success" onclick="approveUser('practitioner', ${practitioner.id})">Approve</button>
                            <button class="btn btn-danger" onclick="rejectUser('practitioner', ${practitioner.id})">Reject</button>
                        </td>
                    `;
                    practitionersTable.appendChild(row);
                });
            }
        }
        
        // Update appointment status
        function updateAppointmentStatus(id, status) {
            const appointment = appointments.find(a => a.id === id);
            if (appointment) {
                appointment.status = status;
                loadAppointments();
                loadUpcomingAppointments();
                alert(`Appointment status updated to ${status}`);
            }
        }
        
        // Cancel appointment
        function cancelAppointment(id) {
            if (confirm('Are you sure you want to cancel this appointment?')) {
                updateAppointmentStatus(id, 'CANCELED');
            }
        }
        
        // Approve user (admin)
        function approveUser(type, id) {
            if (type === 'patient') {
                const index = pendingPatients.findIndex(p => p.id === id);
                if (index !== -1) {
                    const patient = pendingPatients[index];
                    pendingPatients.splice(index, 1);
                    
                    // In a real app, you would update the patient's approved status in the database
                    alert('Patient approved successfully!');
                    loadAdminData();
                }
            } else if (type === 'practitioner') {
                const index = pendingPractitioners.findIndex(p => p.id === id);
                if (index !== -1) {
                    const practitioner = pendingPractitioners[index];
                    pendingPractitioners.splice(index, 1);
                    
                    // Add to approved practitioners list
                    practitioners.push({
                        id: practitioner.id,
                        name: practitioner.name,
                        email: practitioner.email,
                        phone: practitioner.phone,
                        specialization: practitioner.specialization
                    });
                    
                    alert('Practitioner approved successfully!');
                    loadAdminData();
                }
            }
        }
        
        // Reject user (admin)
        function rejectUser(type, id) {
            if (confirm(`Are you sure you want to reject this ${type}?`)) {
                if (type === 'patient') {
                    const index = pendingPatients.findIndex(p => p.id === id);
                    if (index !== -1) {
                        pendingPatients.splice(index, 1);
                        alert('Patient rejected!');
                        loadAdminData();
                    }
                } else if (type === 'practitioner') {
                    const index = pendingPractitioners.findIndex(p => p.id === id);
                    if (index !== -1) {
                        pendingPractitioners.splice(index, 1);
                        alert('Practitioner rejected!');
                        loadAdminData();
                    }
                }
            }
        }
        
        // Logout
        function logout() {
            currentUser = null;
            currentRole = null;
            
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('home-section').style.display = 'block';
            
            alert('You have been logged out.');
        }
    </script>
</body>
</html>
